#include <pic.h>
#include <stdio.h>
unsigned char recv_data;

enum USART_DATA_TYPE
{
    CAR_CHANGE_STA = 1,
    CAR_SPEED_UP,
    CAR_SPEED_MID,
    CAR_SPEED_DOWN
};

/*
	??    ??	????????
	??    ??	??
	?? ?? ?	??
	???????	??
*/

//putchar?????
void putch(unsigned char ch)
{
    TXREG=ch;
    while(TRMT==0);
}

/*??????????*/
void Serial_PrintString(unsigned char *String)
{
	while(*String != '\0')
	{
		printf("%c",*String++);
	}
}

void Usart_GPIO_Init(void)
{
	TRISC6=1;
	TRISC7=1;
}
/*
	??    ??	????????????
	??    ??	??
	?? ?? ?	??
	???????	??
*/
void Usart_Init(void)
{
    TXSTA=0B00100100;//??????????8λ?????????????
    RCSTA=0B10010000;//?????????????????????????????8λ????
    SPBRG=12;//???????????19200
    GIE=1;//???ж????
    PEIE=1;//???????ж????
    RCIE=1;//????USART?????ж?	
}

void usart_Interrupt(void)//usart接收
{
    if (RCIE && RCIF)
    {
        recv_data = RCREG;
        RCIF = 0;
    }  
}

unsigned char usart_GetData(void)//读取接收数据
{
    if (!recv_data)
    {
        return 0;
    }
    
    unsigned char temp = recv_data;
    recv_data = 0;
    return temp;
}

